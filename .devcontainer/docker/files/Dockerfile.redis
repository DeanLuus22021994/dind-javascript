FROM redis:7-alpine

# Install monitoring tools
RUN apk add --no-cache \
  procps \
  htop

# Create data directory with proper permissions
RUN mkdir -p /data && chown redis:redis /data

# Health check optimized for Redis
HEALTHCHECK --interval=10s --timeout=3s --retries=3 --start-period=10s \
  CMD redis-cli ping || exit 1

# Use custom configuration
CMD ["redis-server", "/usr/local/etc/redis/redis.conf"]
