FROM registry:2

# Install additional tools for registry management
RUN apk add --no-cache \
  curl \
  wget \
  jq

# Health check optimized for Registry
HEALTHCHECK --interval=30s --timeout=10s --retries=3 --start-period=20s \
  CMD wget --quiet --tries=1 --spider http://localhost:5000/v2/ || exit 1

# Expose registry port
EXPOSE 5000

# Default command
CMD ["registry", "serve", "/etc/docker/registry/config.yml"]
